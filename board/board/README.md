Next.js 로 게시판 만들기

DB입출력 코드는 서버 컴포넌트 안에서 작성하는 것이 좋습니다.
클라이언트 컴포넌트 안에 있는 코드는 유저 브라우저로 전달이 되기 때문에,
민감한 코드들을 클라이언트 컴포넌트에 저장하는 것은 좋지 않은 선택 -> 서버 컴포넌트안에 작성

Link 태그 vs useRouter
Link태그로 페이지 이동이 편한대 왜 useRouter를 사용하는가?

let router = useRouter()

단순 페이지 이동 말고 router.back() 뒤로가기 , router.forward(), router.refresh() 등 앞으로가기 등 여러 기능들을 사용할수 있습니다.

router.prefetch() 페이지 미리로드 기능은 Link 태그에서도 내장되어있습니다.

1. 여러 페이지를 만드려면 Dynamic Route
2. 현재 URL을 아는 방법 props / useRouter

3-tier architecture
유저가 DB에 글을 저장하고 싶을때 바로 DB로 저장하는것이 아닌, 서버에 전송을하고 
서버는 글을 받으면 검사 후 별 이상없으면 DB에 저장
서버 : 유저의 요청을 들어주는 프로그램


Next.js에선 기본적으로 static rendering이 디폴트 값입니다.
이 페이지들은 npm run build할때 만든 html페이지 그대로 유저에게 보냅니다. 페이지 안에 별 기능이 없습니다.
-> 유저에게 빠르게 보여줄 수 있습니다.

반면에 dynamic rendering의 경우, 유저가 페이지에 접속할때마다 html 을 새로 만들어서 보내줍니다.
유저가 많으면 서버가 부담될 수 있습니다. 캐싱기능을 통해 성능을 최적화할 수 있습니다.


두가지 렌더링 방식으로 웹페이지를 유저들에게 보내줍니다.


회원기능
회원가입 시 아이디/비번을 DB에 저장해두고 유저가 로그인을 하면 아이디/비번을 서버로 보냅니다.
서버에서는 아이디/비번을 DB에 있는거랑 비교를 해서 일치여부를 확인합니다. 맞으면 입장권을 유저에게 발급

프론트쪽에서 서버에 GET/POST 요청 시 입장권도 함께 제시합니다. 서버는 입장권에 이상이 없으면 게시물 데이터를 보내줍니다.

여기서 입장권이란 ? 유저정보가 적혀있는 간단한 문자자료입니다. 유저에게 안보이게 숨겨놓습니다. 브라우저의 쿠키 저장소를
이용합니다.

입장권 만드는데 2가지방법 존재합니다.

1. session 방식
 - session id 만 적혀있습니다.(유저정보 이런건 안적혀있음) 유저가 로그인 완료시 DB나 서버 메모리에다가 
  유저의 아이디/ 로그인 날짜 / 유효기간 등 기록해둡니다.
 - 유저가 GET/POST 요청 할때마다 DB를 조회하기 때문에 엄격하게 로그인 상태를 체크할 수 있습니다.
 - 단점은 그만큼 DB조회를 많이하여 부담이 심해질 수 있습니다. ( 유저가 많은 서비스에서는 redis같은 session id 보관용 DB 사용)
 
2. token 방식 (JWT)
  - 유저가 로그인 성공하면 입장권 발급, DB에 저장 안하고, 입장권에 아이디/로그인날짜/유효기간 등을 적어두고 암호화하고 유저에게 
  보냅니다.
  - 유저는 GET/POST 요청 시 입장권을 제출합니다. 서버에서 이상유무를 확인 후 데이터를 보내줍니다.
  - 유저가 입장권을 위조하면? : 입장권을 만들 떄 암호화하여 내용이 변경이 되면 서버에서 위조여부를 알 수 있습니다.
  - GET/POST요청 할때마다 DB조회 필요가 없어 부담이 적습니다. 유저가 매우 많은 서버를 운영하는 사이트에서 즐겨 사용합니다.
  - 다른사람이 입장권을 훔쳐가면, 그 입장권으로 로그인하는 것을 막을수는 없음.
  - 해결책 : 나쁜 입장권 목록을 DB에 저장하여 GET/POST 요청올때마다 입장권 비교 -> 이러면 세션 방식이랑 다른점이 없음

3. OAuth ?
  - 유저의 특정사이트 사용권한 / 정보 빌리기
  - 유저가 a사이트에 로그인하면 사용 권한 같은 것이 있음.
  - 그 사용권한을 b사이트를 운영하는 내가 잠깐 빌릴 수 있음. 이 과정을 정의하는 규칙
  - OAuth 사용 : 소셜로그인

  Next.js에서 회원기능 구현은 NextAuth.js / Auth.js 라이브러리들이 있습니다.
